# 待引入特征与数据源规划 (Roadmap)

本文档记录了 XCSC 服务器上已验证可用，但尚未引入当前特征工程流程的高价值数据元素。这些元素可作为下一阶段模型优化的重点方向。

## 1. 财务基本面数据 (季频)
**状态**: ✅ 接口已验证 (`income`, `balancesheet`, `cashflow`)
**当前缺失**: 目前模型仅使用日频量价和估值数据，缺乏对公司盈利能力和成长性的考量。

### 1.1 利润表 (`income`)
*   **关键字段**:
    *   `n_income_attr_p` (归母净利润): 核心盈利指标。
    *   `total_revenue` (营业总收入): 核心规模指标。
    *   `basic_eps` (基本每股收益): 盈利能力。
*   **建议特征**:
    *   **营收增长率 (YoY)**: `(本期营收 - 去年同期营收) / 去年同期营收`。衡量成长性。
    *   **净利润增长率 (YoY)**: 衡量盈利成长。
    *   **净利率**: `净利润 / 营业收入`。

### 1.2 资产负债表 (`balancesheet`)
*   **关键字段**:
    *   `total_assets` (总资产)
    *   `total_liab` (总负债)
    *   `total_hldr_eqy_exc_min_int` (股东权益)
*   **建议特征**:
    *   **资产负债率**: `总负债 / 总资产`。衡量财务风险（杠杆率）。
    *   **ROE (净资产收益率)**: `净利润 / 股东权益`。巴菲特最看重的指标。

### 1.3 现金流量表 (`cashflow`)
*   **关键字段**:
    *   `n_cashflow_act` (经营活动产生的现金流量净额)
*   **建议特征**:
    *   **盈利质量**: `经营现金流 / 净利润`。判断公司是“真赚钱”还是“纸面富贵”。

---

## 2. 中单资金流向 (Medium Orders)
**状态**: ✅ 接口已验证 (`moneyflow`)
**当前缺失**: 目前特征工程仅区分了“主力”(大单+超大单) 和 “散户”(小单)。“中单”被忽略。

*   **关键字段**:
    *   `buy_md_vol` (中单买入量)
    *   `sell_md_vol` (中单卖出量)
*   **分析逻辑**:
    *   中单通常代表“跟风盘”或“中户”。
    *   **情景分析**:
        *   主力买入 + 散户卖出 = 强力建仓（当前已捕捉）。
        *   主力不动 + 中单买入 = 市场自然热度/跟风。
        *   主力卖出 + 中单买入 = 主力出货给中户（隐蔽出货）。
*   **建议特征**:
    *   `mid_force_net_inflow`: 中单净流入。
    *   `mid_force_ratio`: 中单参与度。

---

## 3. 停复牌与交易状态
**状态**: ✅ 接口已验证 (`daily` 中的 `trade_status`)
**当前缺失**: 目前脚本主要依赖数据是否存在来过滤，未显式处理停牌逻辑。

*   **关键字段**: `trade_status` (交易状态)
*   **建议逻辑**:
    *   在训练前显式剔除 `trade_status != 'T'` (非交易) 的数据。
    *   **复牌异动过滤**: 对于刚复牌的股票（过去 N 天无交易），其波动率指标可能失真，需特殊处理或暂时剔除。

---

## 4. 待验证的高级接口 (需进一步测试 XCSC 支持情况)
以下接口在标准 Tushare 中可用，但在 XCSC 私有服中尚未测试。

| 接口名 | 描述 | 潜在价值 |
| :--- | :--- | :--- |
| `hk_hold` | 沪深港股通持股 | **北向资金**是 A 股重要的“聪明钱”风向标。 |
| `margin_detail` | 融资融券交易明细 | **杠杆资金**动向，融资买入额高通常代表情绪高涨但风险积聚。 |
| `limit_list` | 涨跌停列表 | (已测试 ❌ 无数据) 捕捉打板策略。 |
| `suspend_d` | 每日停复牌列表 | (未测试 ❓) 比 `daily` 更精准的停牌信息。 |

## 5. 实施计划建议

1.  **第一阶段 (当前)**: 消化 `daily_basic` (估值) 和 `moneyflow` (主力资金) 的新特征。
2.  **第二阶段**: 引入 **中单数据**，完善资金流画像。
3.  **第三阶段**: 引入 **季频财务数据**。
    *   *难点*: 财务数据是低频的（一季度一次），需要通过 `ffill` (向前填充) 映射到日频数据上，且要注意**财报发布日期** (`ann_date`) 以避免未来函数（即不能在财报发布前就用到财报数据）。
