name: Test Google Drive Access

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: âš™ï¸ Install rclone
        run: curl https://rclone.org/install.sh | sudo bash

      - name: ðŸ”‘ Write sa.json
        run: |
          mkdir -p $HOME/.config/rclone
          echo "${{ secrets.GDRIVE_SA_JSON }}" | base64 -d > $HOME/.config/rclone/sa.json

      - name: ðŸ“‚ List "My Drive" root (SA è‡ªå·±çš„ç›˜ï¼Œåº”è¯¥æ˜¯ç©ºçš„)
        run: |
          rclone lsd :drive: \
            --drive-service-account-file=$HOME/.config/rclone/sa.json

      - name: ðŸ“‚ List shared-with-me (åˆ«äººå…±äº«ç»™ SA çš„æ–‡ä»¶å¤¹)
        run: |
          rclone lsd :drive: \
            --drive-service-account-file=$HOME/.config/rclone/sa.json \
            --drive-shared-with-me
