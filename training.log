--- 引导程序: 检查并安装依赖 (v12.1 - Colab 优化模式) ---
检测到环境: LOCAL
使用虚拟环境 Python 作为 pip: /home/jin/.venv/bin/python

【步骤 1/3】: 检查所有必需的包...

【步骤 2/3】: 所有包均已存在。
【步骤 3/3】: 跳过安装。

【信息】:所有依赖已成功加载。
✓ 已选择中文字体: AR PL UMing CN
✓ 配置文件加载成功: /home/jin/work/training/config.yaml

--- 步骤 1: 自动环境检测与路径配置 ---
检测到环境: LOCAL
BASE_DIR: /home/jin/work
ARCHIVE_PATH: /home/jin/work/parquet-data.tar.gz
GDRIVE_BASE_PATH: /home/jin/work
DATA_DIR: /home/jin/work/data/

--- 训练模式配置 (v20) ---
结果存储根目录: /home/jin/work/optuna_results
请选择模式:
  [n] 新训练 (New)      - 创建带时间戳的新目录 (例如 run_2023...)
  [c] 继续训练 (Continue) - 选择已有目录继续优化
请输入模式 (n/c) [默认 n]: >> 已创建新训练目录: run_20251203_094936
本次运行结果将保存至: /home/jin/work/optuna_results/run_20251203_094936
检查缓存文件: /home/jin/work/feature_cache_10000_e3da0b26.parquet

[!] 发现已存在的特征缓存: feature_cache_10000_e3da0b26.parquet
    如果你修改了特征工程代码(apply_technical_indicators)，请选择 'n' 以重新计算。
    是否加载此缓存? [y/n] (默认 y): [I 2025-12-03 09:49:40,143] A new study created in RDB with name: catboost_stock_3class_v16
[I 2025-12-03 09:50:08,494] Trial 0 finished with value: 0.3701247075575535 and parameters: {'vol_multiplier': 0.9175832105442041, 'iterations': 1719, 'learning_rate': 0.07746840844847996, 'depth': 10, 'subsample': 0.7358914407190751, 'l2_leaf_reg': 1.408932621460271e-05, 'min_data_in_leaf': 17}. Best is trial 0 with value: 0.3701247075575535.
[I 2025-12-03 09:50:39,573] Trial 1 finished with value: 0.3714706201936615 and parameters: {'vol_multiplier': 0.940715381040922, 'iterations': 1719, 'learning_rate': 0.07283709146811394, 'depth': 10, 'subsample': 0.8407597708289432, 'l2_leaf_reg': 4.0561089545090694e-06, 'min_data_in_leaf': 23}. Best is trial 1 with value: 0.3714706201936615.
[I 2025-12-03 09:51:04,232] Trial 2 finished with value: 0.37312130493752305 and parameters: {'vol_multiplier': 0.9796116241766232, 'iterations': 1735, 'learning_rate': 0.0701140306921035, 'depth': 10, 'subsample': 0.843538290759076, 'l2_leaf_reg': 1.519182634682645e-07, 'min_data_in_leaf': 99}. Best is trial 2 with value: 0.37312130493752305.
[I 2025-12-03 09:51:28,126] Trial 3 finished with value: 0.37588308150090866 and parameters: {'vol_multiplier': 0.9616235326145555, 'iterations': 1807, 'learning_rate': 0.06661099886264173, 'depth': 10, 'subsample': 0.7161362308279883, 'l2_leaf_reg': 8.173737300368122e-08, 'min_data_in_leaf': 44}. Best is trial 3 with value: 0.37588308150090866.
[I 2025-12-03 09:51:52,828] Trial 4 finished with value: 0.3785598812369302 and parameters: {'vol_multiplier': 0.9619776043218344, 'iterations': 1862, 'learning_rate': 0.07330123272707749, 'depth': 10, 'subsample': 0.6530599069228811, 'l2_leaf_reg': 6.614477945202725e-06, 'min_data_in_leaf': 60}. Best is trial 4 with value: 0.3785598812369302.
2025-12-03 09:52:07,609 - ERROR - 试验 5: TimeSeriesSplit 或 CV 期间发生意外错误。
Traceback (most recent call last):
  File "/home/jin/work/training/模型训练.py", line 1040, in objective
    raise optuna.TrialPruned()
optuna.exceptions.TrialPruned
[I 2025-12-03 09:52:07,635] Trial 5 finished with value: 0.0 and parameters: {'vol_multiplier': 0.9311455793870612, 'iterations': 1728, 'learning_rate': 0.0711395927020572, 'depth': 10, 'subsample': 0.8894356928372091, 'l2_leaf_reg': 1.2592217330146401e-05, 'min_data_in_leaf': 25}. Best is trial 4 with value: 0.3785598812369302.
2025-12-03 09:52:23,138 - ERROR - 试验 6: TimeSeriesSplit 或 CV 期间发生意外错误。
Traceback (most recent call last):
  File "/home/jin/work/training/模型训练.py", line 1040, in objective
    raise optuna.TrialPruned()
optuna.exceptions.TrialPruned
[I 2025-12-03 09:52:23,163] Trial 6 finished with value: 0.0 and parameters: {'vol_multiplier': 0.9029172604327415, 'iterations': 1770, 'learning_rate': 0.06896006222280887, 'depth': 10, 'subsample': 0.6571835056763105, 'l2_leaf_reg': 0.0019122140056407548, 'min_data_in_leaf': 30}. Best is trial 4 with value: 0.3785598812369302.
[I 2025-12-03 09:58:27,788] Trial 7 finished with value: 0.4643374246480093 and parameters: {'vol_multiplier': 0.9746355552420476, 'iterations': 1719, 'learning_rate': 0.06615328536255093, 'depth': 10, 'subsample': 0.6020932740820151, 'l2_leaf_reg': 6.721764667564999, 'min_data_in_leaf': 37}. Best is trial 7 with value: 0.4643374246480093.
[I 2025-12-03 10:04:27,689] Trial 8 finished with value: 0.4635662100925669 and parameters: {'vol_multiplier': 0.9308196258978819, 'iterations': 1781, 'learning_rate': 0.07736400010330402, 'depth': 10, 'subsample': 0.8563878893957787, 'l2_leaf_reg': 0.02668895167083765, 'min_data_in_leaf': 20}. Best is trial 7 with value: 0.4643374246480093.
[I 2025-12-03 10:06:07,761] Trial 9 finished with value: 0.4025628328500536 and parameters: {'vol_multiplier': 0.9363978982389711, 'iterations': 1887, 'learning_rate': 0.0669106550895362, 'depth': 10, 'subsample': 0.8538219202109465, 'l2_leaf_reg': 0.0005887178829165431, 'min_data_in_leaf': 42}. Best is trial 7 with value: 0.4643374246480093.
